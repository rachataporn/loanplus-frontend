<div class="animated fadeIn">
  <div class="row">
    <div class="col-12">
      <form [formGroup]="loanAgreementForm" [class.validated]="submitted" [focusInvalid]="focusToggle">
        <tabset>
          <tab heading="{{'Label.LOTS03.contractInformation'| translate}}" (select)="tabSelected(1)">
            <card header="{{ 'Label.LOTS03.statusContractCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-sm-4 col-md-4">
                    <label class="require" for="CustomerCode">{{ 'Label.LOTS03.CustomerCode'|
                      translate }}</label>
                    <input type="text" class="form-control" formControlName="CustomerName">
                  </div>
                  <div class="form-group col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" style="margin-top: 30px;" (click)="linkCustomerDetail()">{{
                      'Label.LOTS03.linkToCustomer'|
                      translate}}</button>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label class="require" for="CategoryId">{{ 'Label.LOTS03.CategoryId'| translate
                      }}</label>
                    <ng-select [items]="SecuritiesCategories" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="CategoryId" placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                    </ng-select>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label>{{ 'Label.LOTS03.CompanyCode'| translate }}</label>
                    <input *ngIf="lang.CURRENT == 'Tha'" type="text" class="form-control"
                      formControlName="CompanyNameTha">
                    <input *ngIf="lang.CURRENT == 'Eng'" type="text" class="form-control"
                      formControlName="CompanyNameEng">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-6">
                    <label class="require" for="LoanTypeCode">{{ 'Label.LOTS03.LoanTypeCode'|
                      translate }}</label>
                    <ng-select [items]="loanType" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="LoanTypeCode" placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                    </ng-select>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-6 col-md-3">
                    <label class="require">{{ 'Label.LOTS03.ContractType'| translate}}</label>
                    <div class="btn-group d-block" btnRadioGroup formControlName="ContractType">
                      <button [btnRadio]="detail.Value" *ngFor="let detail of contractTypeList"
                        class="btn btn-outline-warning" tabindex="0">{{
                        detail['Text'+lang.CURRENT]}}</button>
                    </div>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label>{{ 'Label.LOTS03.ContractStatus'| translate}}</label>
                    <h5>
                      <span class="badge badge-primary w-100">{{
                        contractHead['ContractStatus'+lang.CURRENT] }}</span>
                    </h5>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-3">
                    <label class="require" for="ContractNo">{{ 'Label.LOTS03.ContractNo'| translate
                      }}</label>
                    <input type="text" class="form-control text-center" placeholder="AUTO" formControlName="ContractNo"
                      maxlength="50" readonly>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-6 col-md-3">
                    <label class="require">{{ 'Label.LOTS03.MainContractNo'| translate}}</label>
                    <input type="text" class="form-control text-center" formControlName="MainContractNo" maxlength="50"
                      readonly>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label for="OldContractId">{{ 'Label.LOTS03.OldContractId'| translate }}</label>
                    <ng-select [items]="contractReFinanceData" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="OldContractId" placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                    </ng-select>
                  </div>
                  <div class="form-group col-sm-6 col-md-3">
                    <label for="ContractDate">{{ 'Label.LOTS03.ContractDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="ContractDate" />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-3">
                    <label class="require">{{ 'Label.LOTS03.MainLoanPrincipleAmount'|
                      translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control"
                      formControlName="MainLoanPrincipleAmount" [decimals]="0">
                    </ngx-numeric-textbox>
                  </div>
                  <div class="form-group col-sm-6 col-md-3">
                    <label>{{ 'Label.LOTS03.TotalAllContractAmount'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="TotalAllContractAmount"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                  </div>
                  <div class="form-group col-sm-6 col-md-6">
                    <label for="LoanObjective">{{ 'Label.LOTS03.LoanObjective'| translate }}</label>
                    <input type="text" class="form-control" formControlName="LoanObjective">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-3">
                    <label>{{ 'Label.LOTS03.OldContractNo'| translate }}</label>
                    <input type="text" class="form-control" formControlName="OldContractNo" maxlength="50">
                  </div>
                  <div class="form-group col-sm-6 col-md-3">
                    <label for="ContractNo">{{ 'พนักงานผู้บันทึกสัญญา'| translate
                      }}</label>
                    <input type="text" class="form-control" formControlName="EmployeeNameContract" maxlength="500"
                      readonly>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label>{{ 'Label.LOTS03.SignatureStatus'| translate}}</label>
                    <h5>
                      <span class="badge badge-primary w-100">{{
                        contractHead['SignatureStatus'+lang.CURRENT] }}</span>
                    </h5>
                  </div>
                  <div class="form-group col-sm-3 col-md-3">
                    <label>{{ 'ช่องทางการทำสัญญา'| translate}}</label>
                    <h5>
                      <span class="badge badge-primary w-100">{{
                        contractHead['ReqType'+lang.CURRENT] }}</span>
                    </h5>
                  </div>
                </div>
                <div class="form-row" *ngIf="IsSuperUser">
                  <div class="form-group col-sm-6 col-md-4">
                    <div class="custom-control custom-checkbox" style="margin-top: 30px">
                      <input class="custom-control-input" type="checkbox" id="IsNotRefinance"
                        formControlName="IsNotRefinance">
                      <label class="custom-control-label" for="IsNotRefinance">
                        {{ 'ไม่อนุญาตให้ทำการรีไฟแนนซ์'| translate}}
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card
              header="{{ 'Label.LOTS03.customerCard'| translate }} : {{ 'Label.LOTS04.RemarkcustomerCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12">
                    <aaa-grid-no-pager #detailgrd [rows]="contractBorrowers">
                      <ngx-datatable-column name="CustomerCode" [cellClass]="'text-center'">
                        <ng-template ngx-datatable-header-template>
                          <label class="require" class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.CustomerCode'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['CustomerCode'] }}
                        </ng-template>
                        <div class="invalid-feedback">
                          {{ 'Message.STD00000' | translate }}
                        </div>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="CustomerName+lang">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.CustomerName'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['CustomerName'+lang.CURRENT] }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column width="80" [cellClass]="'text-center'" [sortable]="false">
                        <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                          <button class="btn btn-sm btn-primary" (click)="linkCustomerDetail(row.CustomerCode)">{{
                            'Label.LOTS03.linkToCustomer'| translate}}</button>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="LoanAmount" [cellClass]="'text-right'">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.loanAmount'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['LoanAmount'] | number:'1.2-2' }}
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-grid-no-pager>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card header="{{ 'Label.LOTS03.customerSecuritiesCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12" formArrayName="contractSecuritiess">
                    <aaa-grid-no-pager #detailgrd [rows]="contractSecuritiess.value" [formArray]="contractSecuritiess"
                      [summaryRow]="true">

                      <ngx-datatable-column name="CustomerSecuritiesId" width="200">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper require">{{
                            'Label.LOTS03.customerSecurities'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['securities'+lang.CURRENT] }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="Description" [summaryTemplate]="summaryLabel">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.description'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['Description'] }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="loanLimitAmount" [cellClass]="'text-right'"
                        [summaryTemplate]="productSummary">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.loanLimitAmount'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          {{ row['loanLimitAmount'] | number:'1.2-2' }}
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-grid-no-pager>
                    <ng-template #summaryLabel>
                      <div class="custom-template-body text-right">
                        <label>{{ 'Label.LOTS03.summaryLoanLimitAmount'| translate}}</label>
                      </div>
                    </ng-template>
                    <ng-template #productSummary>
                      <div class="custom-template-body  text-right">
                        {{ summary() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card header="{{ 'Label.LOTS03.contractItemCard'| translate }}" [isCollapsed]="true">
              <div class="card-content">
                <card header="{{ 'Label.LOTS03.income'| translate }}">
                  <div class="card-menu">
                    <button *ngIf="loanAgreementForm.controls.editStatus.value !== '1'" type="button"
                      class="btn btn-sm btn-circle btn-secondary" (click)="addContractIncomeItem()"
                      tooltip="{{ 'Label.GLOBAL.Add' | translate }}">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractIncomeItems">
                        <aaa-grid #detailgrd [rows]="contractIncomeItems.value" [formArray]="contractIncomeItems">
                          <ngx-datatable-column name="Name{lang}" width="200">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper require">{{'Label.LOTS03.LoItemCode'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <ng-select class="sm" appendTo="body" dropdownPosition="bottom" [items]="incomeLoan"
                                  (open)="filterIncomeLoan(row.ContractItemId)" [bindLabel]="'Text'+lang.CURRENT"
                                  bindValue="Value" formControlName="LoItemCode"
                                  placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                                </ng-select>
                                <div class="invalid-feedback">
                                  {{ 'Message.STD00000' | translate }}
                                </div>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper require">{{
                                'Label.LOTS03.Amount'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <ngx-numeric-textbox inputClass="form-control form-control-sm" formControlName="Amount"
                                  [min]="0" [decimals]="2">
                                </ngx-numeric-textbox>
                                <div class="invalid-feedback">
                                  {{ 'Message.STD00000' | translate }}
                                </div>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="60">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeRowContractIncomeItem(rowIndex);">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
                <br />
                <card header="{{ 'Label.LOTS03.cost'| translate }}">
                  <div class="card-menu">
                    <button *ngIf="loanAgreementForm.controls.editStatus.value !== '1'" type="button"
                      class="btn btn-sm btn-circle btn-secondary" (click)="addContractPaymentItem()"
                      tooltip="{{ 'Label.GLOBAL.Add' | translate }}">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractPaymentItems">
                        <aaa-grid #detailgrd [rows]="contractPaymentItems.value" [formArray]="contractPaymentItems">
                          <ngx-datatable-column name="Name{lang}" width="200">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper require">{{'Label.LOTS03.LoItemCode'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <ng-select class="sm" appendTo="body" dropdownPosition="bottom" [items]="paymentLoan"
                                  (open)="filterPaymentLoan(row.ContractItemId)" [bindLabel]="'Text'+lang.CURRENT"
                                  bindValue="Value" formControlName="LoItemCode"
                                  placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                                </ng-select>
                                <div class="invalid-feedback">
                                  {{ 'Message.STD00000' | translate }}
                                </div>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper require">{{
                                'Label.LOTS03.Amount'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <ngx-numeric-textbox inputClass="form-control form-control-sm" formControlName="Amount"
                                  [min]="0" [decimals]="2">
                                </ngx-numeric-textbox>
                                <div class="invalid-feedback">
                                  {{ 'Message.STD00000' | translate }}
                                </div>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="60">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeRowContractPaymentItem(rowIndex);">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </div>
            </card>
            <br />
            <card header="{{ 'Label.LOTS03.contractAmountCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label class="require" for="PayType">{{ 'Label.LOTS03.PayType'| translate
                      }}</label>
                    <ng-select [items]="pays" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="PayType" placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                    </ng-select>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-md-4">
                    <label class="require">{{ 'Label.LOTS03.ReqLoanAmount'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="ReqLoanAmount"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback" *ngIf="loanAgreementForm.controls.ReqLoanAmount.invalid">
                      <div *ngIf="loanAgreementForm.controls.ReqLoanAmount.errors.required">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                      <div *ngIf="maxLoanMsg || loanAgreementForm.controls.ReqLoanAmount.errors.invalid">
                        {{ 'Message.LO00001' | translate }}
                      </div>
                    </div>
                  </div>
                  <div class="form-group col-md-4">
                    <label class="require">{{ 'Label.LOTS03.CanLoanTotalAmount'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="TotalAmount"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label class="require">{{ 'Label.LOTS03.ReqTotalPeriod'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="ReqTotalPeriod"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-md-4">
                    <label class="require">{{ 'Label.LOTS03.ReqGapPeriod'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="ReqGapPeriod"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-md-4">
                    <label class="require">{{ 'Label.LOTS03.ReqTotalMonth'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="ReqTotalMonth"
                      [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                </div>
              </div>
            </card>
          </tab>
          <tab heading="{{'Label.LOTS03.installments'| translate}}" (select)="tabSelected(2)">
            <card header="{{ 'Label.LOTS03.datePaymentCard'| translate }}">
              <div class="card-content">
                <div class="form-row justify-content-md-center">
                  <div class="form-group col-lg-2">
                    <label class="require">{{ 'Label.LOTS03.ApprovedDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="ApprovedDate" />
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-lg-2">
                    <label class="require">{{ 'Label.LOTS03.StartPaymentDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="StartPaymentDate"
                      [minDate]="loanAgreementForm.controls.ApprovedDate.value" />
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                </div>
                <div class="form-row justify-content-md-center">
                  <div class="form-group col-lg-2">
                    <label class="require">{{ 'Label.LOTS03.TransferDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="TransferDate"
                      [minDate]="loanAgreementForm.controls.ApprovedDate.value" />
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-lg-2">
                    <label class="require">{{ 'Label.LOTS03.EndPaymentDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="EndPaymentDate" />
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                </div>
                <div class="form-row justify-content-md-center">
                  <div class="form-group col-lg-2">
                    <label class="require">{{ 'Label.LOTS03.StartInterestDate'| translate}}</label>
                    <input bsDatepicker class="form-control" type="text" formControlName="StartInterestDate"
                      [minDate]="loanAgreementForm.controls.TransferDate.value" />
                    <div class="invalid-feedback">
                      {{ 'Message.STD00000' | translate }}
                    </div>
                  </div>
                  <div class="form-group col-lg-2"></div>
                </div>
              </div>
            </card>
            <br />
            <div class="form-row">
              <card class="col-md-6" header="{{ 'Label.LOTS03.amountApproveCard'| translate }}">
                <div class="card-content">
                  <div class="form-row">
                    <div class="form-group col-md-5">
                      <label class="require">{{ 'Label.LOTS03.AppLoanTotalPeriod'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppLoanTotalPeriod"
                        [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-3">
                      <label class="require">{{ 'Label.LOTS03.MaximumInterestRate'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="MaximumInterestRate"
                        [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-4">
                      <label class="require">{{ 'Label.LOTS03.AppLoanInterestRate'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppLoanInterestRate"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-5">
                      <label class="require">{{ 'Label.LOTS03.AppLoanPrincipleAmount'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control"
                        formControlName="AppLoanPrincipleAmount" [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-3">
                      <label class="require">{{ 'Label.LOTS03.AppLoanEffectiveInterestRate'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control"
                        formControlName="AppLoanEffectiveInterestRateYear" [decimals]="2">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-4">
                      <label>{{ 'Label.LOTS03.AppLoanInterestAmount'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control"
                        formControlName="AppLoanInterestAmount" [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-5">
                      <label class="require">{{ 'Label.LOTS03.AppLoanPeriodAmount'|
                        translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppLoanPeriodAmount"
                        [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-4">
                      <label>{{ 'Label.LOTS03.AppLoanAmountTotal'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppLoanAmountTotal"
                        [decimals]="0">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                  </div>
                </div>
              </card>
              <card class="col-md-4" header="{{ 'Label.LOTS03.feeCard'| translate }}">
                <div class="card-content">
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeRate1'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeRate1"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeAmount1'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeAmount1"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeRate2'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeRate2"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                    </div>
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeAmount2'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeAmount2"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeRate3'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeRate3"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                    </div>
                    <div class="form-group col-md-6">
                      <label>{{ 'Label.LOTS03.AppFeeAmount3'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AppFeeAmount3"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                    </div>
                  </div>
                </div>
              </card>
              <card class="col-md-2" header="{{ 'Label.LOTS03.latePaymentCard'| translate }}">
                <div class="card-content">
                  <div class="form-row">
                    <div class="form-group col-12">
                      <label for="LatePaymentDay">{{ 'Label.LOTS03.LatePaymentDay'| translate
                        }}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="LatePaymentDay"
                        [decimals]="0">
                      </ngx-numeric-textbox>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-12">
                      <label>{{ 'Label.LOTS03.LatePaymentFeeRate'| translate}}</label>
                      <ngx-numeric-textbox inputClass="form-control form-control" formControlName="LatePaymentFeeRate"
                        [decimals]="2">
                      </ngx-numeric-textbox>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="form-group col-12">
                      <br />
                      <br />
                      <br />
                    </div>
                  </div>
                </div>
              </card>
            </div>
            <br />
          </tab>
          <tab heading="{{ 'Label.LOTS03.AllpreriodCard'| translate }}" (select)="tabSelected(3)">
            <card header="{{ 'Label.LOTS03.AllActualPaymentCard'| translate }}">
              <div class="card-content">
                <div class="col-12">
                  <aaa-grid-no-pager #detailgrd [rows]="AllContractReceivePeriod" [summaryRow]="true">
                    <ngx-datatable-column name="ReceiveDate" [cellClass]="'text-center'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveDate'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiptDate | thaidate }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptNo" [cellClass]="'text-center'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveNo'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        <span class="link"
                          (click)="linkReceiptDetail(row.ReceiptHeadId, row.DocumentType)">{{row.ReceiptNo}}</span>
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptTypeCode"
                      [summaryTemplate]="summaryAllcontractReceivePeriodLabel">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ประเภทการรับชำระ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{row.ReceiptTypeCode}}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptTotalAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllReceiptAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ActualAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiptTotalAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="Period" [cellClass]="'text-center'" width="80">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.Period }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ApplyAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyPrincipleAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyPrincipleAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ApplyPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyPrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyInterestAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyInterestAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ApplyInterestAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyInterestAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplySequesterAmt" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplySequesterAmt">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าติดตามบังคับทรัพย์สิน'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplySequesterAmt | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyMoveRefinAmt" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyMoveRefinAmt">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าย้ายรีไฟแนนซ์'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyMoveRefinAmt | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyFineAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyFineAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าปรับ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyFineAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyDebtCollectionAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyDebtCollectionAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าติดตาม'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyDebtCollectionAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <!-- <ngx-datatable-column name="ReceiptAdvanceAmount" [cellClass]="'text-right'"
                                            [summaryTemplate]="SummaryAllReceiptAdvanceAmount">
                                            <ng-template ngx-datatable-header-template>
                                                <label
                                                    class="datatable-header-cell-wrapper">{{ 'รับชำระล่วงหน้า'| translate}}</label>
                                            </ng-template>
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{ row.ReceiptAdvanceAmount | number:0 }}
                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-column name="BalanceReceiptAdvanceAmount"
                                            [cellClass]="'text-right'">
                                            <ng-template ngx-datatable-header-template>
                                                <label
                                                    class="datatable-header-cell-wrapper">{{ 'ค้างรับชำระล่วงหน้า'| translate}}</label>
                                            </ng-template>
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{ row.BalanceReceiptAdvanceAmount | number:0 }}
                                            </ng-template>
                                        </ngx-datatable-column> -->
                    <ngx-datatable-column name="BalancePrincipleAmount" [cellClass]="'text-right'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.BalPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.BalancePrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ng-template #summaryAllcontractReceivePeriodLabel>
                      <div class="custom-template-body text-right">
                        <label>{{ 'รวม'| translate}}</label>
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllReceiptAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllReceiptAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyPrincipleAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyPrincipleAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyInterestAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyInterestAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyFineAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyFineAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyDebtCollectionAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyDebtCollectionAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllReceiptAdvanceAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllReceiptAdvanceAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplySequesterAmt>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplySequesterAmt() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllApplyMoveRefinAmt>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllApplyMoveRefinAmt() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                  </aaa-grid-no-pager>
                </div>
              </div>
            </card>
            <br />
            <br />
            <card header="{{ 'Label.LOTS03.AllPaymentPlanCard'| translate }}">
              <div class="card-content">
                <div class="col-12">
                  <aaa-grid-no-pager #detailgrd [rows]="AllContractPeriods" [summaryRow]="true">
                    <ngx-datatable-column name="Period" [cellClass]="'text-center'" width="80">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.Period }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiveDate" [cellClass]="'text-center'"
                      [summaryTemplate]="summaryPeriodLabel">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveDate'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiveDate | thaidate }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="TotalAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllTotalAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.TotalAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.TotalAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="PrincipleAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllPrincipleAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.PrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.PrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="InterestAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllInterestAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.InterestAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.InterestAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="BalPrincipleAmount" [cellClass]="'text-right'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.BalPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.BalancePrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ng-template #summaryAllPeriodLabel>
                      <div class="custom-template-body text-right">
                        <label>{{ 'Label.LOTS03.summaryLoanLimitAmount'| translate}}</label>
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllTotalAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllTotalAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllPrincipleAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllPrincipleAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryAllInterestAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryAllInterestAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                  </aaa-grid-no-pager>
                </div>
              </div>
            </card>
            <br />
          </tab>
          <tab heading="{{ 'Label.LOTS03.preriodCard'| translate }}" (select)="tabSelected(4)">
            <card header="{{ 'Label.LOTS03.ActualPaymentCard'| translate }}">
              <div class="card-content">
                <div class="col-12">
                  <aaa-grid-no-pager #detailgrd [rows]="contractReceivePeriod" [summaryRow]="true">
                    <ngx-datatable-column name="ReceiptDate" [cellClass]="'text-center'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveDate'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiptDate | thaidate }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptNo" [cellClass]="'text-center'" width="150"
                      [summaryTemplate]="summarycontractReceivePeriodLabel">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'เลขที่รับชำระ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        <span class="link"
                          (click)="linkReceiptDetail(row.ReceiptHeadId, row.DocumentType)">{{row.ReceiptNo}}</span>
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptTypeCode"
                      [summaryTemplate]="summaryAllcontractReceivePeriodLabel">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ประเภทการรับชำระ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{row.ReceiptTypeCode}}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiptTotalAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryReceiptTotalAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ActualAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiptTotalAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="Period" [cellClass]="'text-center'" width="80">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.Period }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryApplyAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ยอดรับชำระ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyPrincipleAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryApplyPrincipleAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ApplyPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyPrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyInterestAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryApplyInterestAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ApplyInterestAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyInterestAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplySequesterAmt" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplySequesterAmt">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าติดตามบังคับทรัพย์สิน'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplySequesterAmt | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyMoveRefinAmt" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryAllApplyMoveRefinAmt">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าย้ายรีไฟแนนซ์'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyMoveRefinAmt | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyFineAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryApplyFineAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าปรับ'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyFineAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ApplyDebtCollectionAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryApplyDebtCollectionAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'ชำระค่าติดตาม'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.ApplyDebtCollectionAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="BalancePrincipleAmount" [cellClass]="'text-right'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.BalPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" ngx-datatable-cell-template>
                        {{ row.BalancePrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ng-template #summarycontractReceivePeriodLabel>
                      <div class="custom-template-body text-right">
                        <label>{{ 'รวม'| translate}}</label>
                      </div>
                    </ng-template>
                    <ng-template #SummaryReceiptTotalAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryReceiptTotalAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyPrincipleAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyPrincipleAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyInterestAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyInterestAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyFineAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyFineAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyDebtCollectionAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyDebtCollectionAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplySequesterAmt>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplySequesterAmt() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryApplyMoveRefinAmt>
                      <div class="custom-template-body  text-right">
                        {{ summaryApplyMoveRefinAmt() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                  </aaa-grid-no-pager>
                </div>
              </div>
            </card>
            <br />
            <br />
            <card header="{{ 'Label.LOTS03.PaymentPlanCard'| translate }}">
              <div class="card-content">
                <div class="col-12">
                  <aaa-grid-no-pager #detailgrd [rows]="periods" [summaryRow]="true">
                    <ngx-datatable-column name="Period" [cellClass]="'text-center'" width="80">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                          translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.Period }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="ReceiveDate" [cellClass]="'text-center'"
                      [summaryTemplate]="summaryPeriodLabel">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.ReceiveDate'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.ReceiveDate | thaidate }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="TotalAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryTotalAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.TotalAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.RoundTotalAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="PrincipleAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryPrincipleAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.PrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.RoundPrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="InterestAmount" [cellClass]="'text-right'"
                      [summaryTemplate]="SummaryInterestAmount">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.InterestAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.RoundInterestAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ngx-datatable-column name="BalPrincipleAmount" [cellClass]="'text-right'">
                      <ng-template ngx-datatable-header-template>
                        <label class="datatable-header-cell-wrapper">{{
                          'Label.LOTS03.BalPrincipleAmount'| translate}}</label>
                      </ng-template>
                      <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                        {{ row.RoundBalancePrincipleAmount | number:0 }}
                      </ng-template>
                    </ngx-datatable-column>
                    <ng-template #summaryPeriodLabel>
                      <div class="custom-template-body text-right">
                        <label>{{ 'Label.LOTS03.summaryLoanLimitAmount'| translate}}</label>
                      </div>
                    </ng-template>
                    <ng-template #SummaryTotalAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryTotalAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryPrincipleAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryPrincipleAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                    <ng-template #SummaryInterestAmount>
                      <div class="custom-template-body  text-right">
                        {{ summaryInterestAmount() | number:'1.2-2' }}
                      </div>
                    </ng-template>
                  </aaa-grid-no-pager>
                </div>
              </div>
            </card>
            <br />
          </tab>
          <tab heading="{{ 'Label.LOTS03.LoaninstallmentDetail'| translate }}" (select)="tabSelected(5)">
            <card header="{{ 'ตารางการค้างชำระรวม'| translate }}">
              <div class="card-menu">
                <button *ngIf="IsSuperUser" type="button" (click)="onApproveRefinanceLaw()"
                  class="btn btn-sm btn-success">
                  อนุมัติให้ปืดสัญญา(กฏหมายแพ่งและพาณิชย์/ประนอมหนี้)
                </button>
              </div>
              <div class="card-content">
                <aaa-grid-no-pager [rows]="AllAccuredBalanceEnding" [summaryRow]="true">
                  <ngx-datatable-column [cellClass]="'text-center'" [width]="80" name="Period">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.Period}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-center'" name="ReceiveDate"
                    [summaryTemplate]="SummaryAllAccuredBalanceEndingLabel">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'งวดวันที่'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.ReceiveDate | thaidate }}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-right'" name="SummaryAccured"
                    [summaryTemplate]="SummaryAllAccuredBalance">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค้างชำระค่างวด'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      <label class="color-danger">
                        {{row.SummaryAccured | number:'1.2-2'}}
                      </label>
                    </ng-template>
                  </ngx-datatable-column>
                  <!-- <ngx-datatable-column [cellClass]="'text-right'"
                                        name="AccuredBalanceEndingPrinciple"
                                        [summaryTemplate]="SummaryAllAccuredBalanceEndingPrinciple">
                                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                            <label
                                                class="datatable-header-cell-wrapper">{{ 'เงินต้นค้างชำระ'| translate}}</label>
                                        </ng-template>
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            {{row.AccuredBalanceEndingPrinciple | number:'1.2-2'}}
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column [cellClass]="'text-right'" name="AccuredBalanceEndingInterest"
                                        [summaryTemplate]="SummaryAllAccuredBalanceEndingInterest">
                                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                            <label
                                                class="datatable-header-cell-wrapper">{{ 'ดอกเบี้ยค้างชำระ'| translate}}</label>
                                        </ng-template>
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            {{row.AccuredBalanceEndingInterest | number:'1.2-2'}}
                                        </ng-template>
                                    </ngx-datatable-column> -->
                  <ngx-datatable-column [cellClass]="'text-right'" name="BalanceFineAmount"
                    [summaryTemplate]="SummaryAllBalanceFineAmount">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค่าปรับค้างชำระ'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.BalanceFineAmount | number:'1.2-2'}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-right'" name="BalanceDebtCollectionAmount"
                    [summaryTemplate]="SummaryAllBalanceDebtCollectionAmount">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค่าติดตามค้างชำระ'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.BalanceDebtCollectionAmount | number:'1.2-2'}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ng-template #SummaryAllAccuredBalanceEndingLabel>
                    <div class="custom-template-body text-right">
                      <label>{{ 'รวม'| translate}}</label>
                    </div>
                  </ng-template>
                  <ng-template #SummaryAllAccuredBalance>
                    <div class="custom-template-body  text-right">
                      {{ summaryAllAccuredBalance() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAllAccuredBalanceEndingPrinciple>
                    <div class="custom-template-body  text-right">
                      {{ summaryAllAccuredBalanceEndingPrinciple() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAllAccuredBalanceEndingInterest>
                    <div class="custom-template-body  text-right">
                      {{ summaryAllAccuredBalanceEndingInterest() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAllBalanceFineAmount>
                    <div class="custom-template-body  text-right">
                      {{ summaryAllBalanceFineAmount() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAllBalanceDebtCollectionAmount>
                    <div class="custom-template-body  text-right">
                      {{ summaryAllBalanceDebtCollectionAmount() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                </aaa-grid-no-pager>
              </div>
            </card>
            <br />
            <card header="{{ 'ตารางการค้างชำระ'| translate }}">
              <div class="card-content">
                <aaa-grid-no-pager [rows]="AccuredBalanceEnding" [summaryRow]="true">
                  <ngx-datatable-column [cellClass]="'text-center'" [width]="80" name="Period">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'Label.LOTS03.Period'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.Period}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-center'" name="ReceiveDate"
                    [summaryTemplate]="SummaryAccuredBalanceEndingLabel">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'งวดวันที่'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.ReceiveDate | thaidate }}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-right'" name="AccuredBalanceEndingPrinciple"
                    [summaryTemplate]="SummaryAccuredBalance">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค้างชำระค่างวด'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      <label class="color-danger">
                        {{row.SummaryAccured | number:'1.2-2'}}
                      </label>
                    </ng-template>
                  </ngx-datatable-column>
                  <!-- <ngx-datatable-column [cellClass]="'text-right'"
                                        name="AccuredBalanceEndingPrinciple"
                                        [summaryTemplate]="SummaryAccuredBalanceEndingPrinciple">
                                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                            <label
                                                class="datatable-header-cell-wrapper">{{ 'เงินต้นค้างชำระ'| translate}}</label>
                                        </ng-template>
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            {{row.AccuredBalanceEndingPrinciple | number:'1.2-2'}}
                                        </ng-template>
                                    </ngx-datatable-column>
                                    <ngx-datatable-column [cellClass]="'text-right'" name="AccuredBalanceEndingInterest"
                                        [summaryTemplate]="SummaryAccuredBalanceEndingInterest">
                                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                            <label
                                                class="datatable-header-cell-wrapper">{{ 'ดอกเบี้ยค้างชำระ'| translate}}</label>
                                        </ng-template>
                                        <ng-template let-row="row" ngx-datatable-cell-template>
                                            {{row.AccuredBalanceEndingInterest | number:'1.2-2'}}
                                        </ng-template>
                                    </ngx-datatable-column> -->
                  <ngx-datatable-column [cellClass]="'text-right'" name="BalanceFineAmount"
                    [summaryTemplate]="SummaryBalanceFineAmount">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค่าปรับค้างชำระ'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.BalanceFineAmount | number:'1.2-2'}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ngx-datatable-column [cellClass]="'text-right'" name="BalanceDebtCollectionAmount"
                    [summaryTemplate]="SummaryBalanceDebtCollectionAmount">
                    <ng-template let-sort="sortFn" ngx-datatable-header-template>
                      <label class="datatable-header-cell-wrapper">{{ 'ค่าติดตามค้างชำระ'|
                        translate}}</label>
                    </ng-template>
                    <ng-template let-row="row" ngx-datatable-cell-template>
                      {{row.BalanceDebtCollectionAmount | number:'1.2-2'}}
                    </ng-template>
                  </ngx-datatable-column>
                  <ng-template #SummaryAccuredBalanceEndingLabel>
                    <div class="custom-template-body text-right">
                      <label>{{ 'รวม'| translate}}</label>
                    </div>
                  </ng-template>
                  <ng-template #SummaryAccuredBalance>
                    <div class="custom-template-body  text-right">
                      {{ summaryAccuredBalance() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAccuredBalanceEndingPrinciple>
                    <div class="custom-template-body  text-right">
                      {{ summaryAccuredBalanceEndingPrinciple() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryAccuredBalanceEndingInterest>
                    <div class="custom-template-body  text-right">
                      {{ summaryAccuredBalanceEndingInterest() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryBalanceFineAmount>
                    <div class="custom-template-body  text-right">
                      {{ summaryBalanceFineAmount() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                  <ng-template #SummaryBalanceDebtCollectionAmount>
                    <div class="custom-template-body  text-right">
                      {{ summaryBalanceDebtCollectionAmount() | number:'1.2-2' }}
                    </div>
                  </ng-template>
                </aaa-grid-no-pager>
              </div>
            </card>
            <br />
            <div *ngIf="loanAgreementForm.controls.editStatus.value == '2' && (loanAgreementForm.controls.ContractStatus.value == 'AP' || loanAgreementForm.controls.ContractStatus.value == 'P')
                            &&  loanAgreementForm.controls.ContractDate.value <= currentDate" class="col-12">
              <div class="d-flex justify-content-start">
                <div class="form-group">
                  <button class="btn btn-primary" (click)="linkPayment(MainContractHeadID, '1')"
                    [disabled]="reFinanceStatus">
                    {{'รับชำระเงิน' | translate}}
                  </button>
                  <button class="btn btn-primary" (click)="linkPayment(MainContractHeadID, '2')"
                    [disabled]="reFinanceStatus">
                    {{'ปิดสัญญากู้เงิน' | translate}}
                  </button>
                  <!-- <button class="btn btn-primary" (click)="onCloseReFinance('1')" [disabled]="reFinanceStatus"
                    *ngIf="CanRefinance && !contractHead.IsNotRefinance"> -->
                  <button class="btn btn-primary" (click)="onCloseReFinance('1')" [disabled]="reFinanceStatus"
                    *ngIf="CanRefinance">
                    <i class="fas fa-cog fa-spin" [hidden]="!reFinanceStatus"></i>
                    <i class="fas fa-ban" [hidden]="reFinanceStatus"></i>
                    {{'Label.LOTS03.closeReFinance' | translate}}
                  </button>
                  <!-- <button class="btn btn-danger" (click)="onCompose()" [disabled]="reFinanceStatus"
                    *ngIf="ContractType != '2' && IsSuperUser">
                    <i class="fas fa-cog fa-spin" [hidden]="!reFinanceStatus"></i>
                    <i class="fas fa-ban" [hidden]="reFinanceStatus"></i>
                    {{'ปิดสัญญา(กฏหมายแพ่งและพาณิชย์)' | translate}}
                  </button>
                  <button class="btn btn-danger" (click)="onCompose()" [disabled]="reFinanceStatus"
                    *ngIf="ContractType != '2' && IsSuperUser">
                    <i class="fas fa-cog fa-spin" [hidden]="!reFinanceStatus"></i>
                    <i class="fas fa-ban" [hidden]="reFinanceStatus"></i>
                    {{'ประนอมหนี้' | translate}}
                  </button> -->
                  <button class="btn btn-danger" (click)="onCloseReFinance('2')" [disabled]="reFinanceStatus"
                    *ngIf="contractHead.IsApproveRefinanceLaw">
                    <i class="fas fa-cog fa-spin" [hidden]="!reFinanceStatus"></i>
                    <i class="fas fa-ban" [hidden]="reFinanceStatus"></i>
                    {{'ปิดสัญญา(กฏหมายแพ่งและพาณิชย์)' | translate}}
                  </button>
                  <button class="btn btn-danger" (click)="onCompose()" [disabled]="reFinanceStatus"
                    *ngIf="contractHead.IsApproveRefinanceLaw">
                    <i class="fas fa-cog fa-spin" [hidden]="!reFinanceStatus"></i>
                    <i class="fas fa-ban" [hidden]="reFinanceStatus"></i>
                    {{'ประนอมหนี้' | translate}}
                  </button>
                </div>
              </div>
            </div>
          </tab>
          <tab heading="{{'Label.LOTS03.payment'| translate}}" (select)="tabSelected(6)">
            <card header="{{ 'Label.LOTS03.paymentDetailCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-6">
                    <label>{{ 'Label.LOTS03.PaymentTypeCode'| translate}}</label>
                    <ng-select [items]="paymentTypeData" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="PaymentTypeCode" placeholder="{{'Label.GLOBAL.PleaseSelect' | translate}}">
                    </ng-select>
                  </div>
                  <div class="form-group col-sm-6 col-md-6">
                    <label>{{'Label.LOTS03.PaymentCompanyAccountId' | translate}}</label>
                    <ng-select [items]="paymentCompanyAccount" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="PaymentCompanyAccountId"
                      placeholder="{{'Label.GLOBAL.PleaseSelect' | translate}}">
                    </ng-select>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card header="{{ 'Label.LOTS03.receivePaymentCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-sm-6 col-md-6">
                    <label>{{ 'Label.LOTS03.CustomerReceiveTypeCode'| translate}}</label>
                    <ng-select [items]="customerReceiveTypeData" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                      formControlName="CustomerReceiveTypeCode"
                      placeholder="{{'Label.GLOBAL.PleaseSelect' | translate}}">
                    </ng-select>
                  </div>
                </div>
                <div class="form-row" *ngFor="let item of contractCustomerAccount">
                  <div class="col-sm-12 col-md-12">
                    <fieldset class="border p-2">
                      <legend class="w-auto">
                        <label>{{ 'Label.LOTS03.BankAccount'| translate}}&nbsp;{{item.CustomerType}}</label>
                      </legend>
                      <div class="form-row">
                        <div class="form-group col-md-3">
                          <label>{{ 'ชื่อลูกค้า'| translate }}</label>
                          <input type="text" class="form-control text-center" value="{{item.CustomerName}}" disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'จำนวนเงินกู้ตามสัญญา'| translate }}</label>
                          <input type="text" class="form-control text-center"
                            value="{{item.AppLoanPrincipleAmount  | number:'1.2-2' }}" disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'ชำระเงินกู้จากสัญญาเก่า(รีไฟแนนซ์) จำนวน'| translate }}</label>
                          <input type="text" class="form-control text-center"
                            value="{{item.OldBalancePrincipleAmount | number:'1.2-2' }}" disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'โอนเงินเข้าบัญชี จำนวน'| translate }}</label>
                          <input type="text" class="form-control text-center"
                            value="{{item.CommercialAccountAmount  | number:'1.2-2' }}" disabled>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="form-group col-md-3">
                          <label>{{ 'Label.LOTS03.CustomerAccountNo'| translate }}</label>
                          <input type="text" class="form-control text-center" value="{{item.CustomerAccountNo}}"
                            disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'Label.LOTS03.CustomerAccountName'| translate }}</label>
                          <input type="text" class="form-control text-center" value="{{item.CustomerAccountName}}"
                            disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'Label.LOTS03.CustomerBankCode'| translate }}</label>
                          <input type="text" class="form-control text-center" value="{{item.BankName}}" disabled>
                        </div>
                        <div class="form-group col-md-3">
                          <label>{{ 'Label.LOTS03.CustomerBranchName'| translate }}</label>
                          <input type="text" class="form-control text-center" value="{{item.CustomerBranchName}}"
                            disabled>
                        </div>
                      </div>
                      <div class="form-row">
                        <div class="col-12">
                          <aaa-grid #detailgrid [rows]="item.CustomerAccountAttachment.Rows">
                            <ngx-datatable-column>
                              <ng-template ngx-datatable-header-template>
                                <label>{{ 'Label.LOTS03.attachment'| translate}}</label>
                              </ng-template>
                              <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                ngx-datatable-cell-template>
                                <file-customer-attachment [file]="row.AttachmentId" [fileName]="row.FileName"
                                  [category]="categoryCustomer" [isDisable]="row.IsDisableAttachment">
                                </file-customer-attachment>
                              </ng-template>
                            </ngx-datatable-column>
                            <ngx-datatable-column>
                              <ng-template ngx-datatable-header-template>
                                <label class="datatable-header-cell-wrapper">{{'Label.LOTS03.Description'| translate
                                  }}</label>
                              </ng-template>
                              <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                ngx-datatable-cell-template>
                                <input type="text" class="form-control form-control-sm" value="{{row.Description}}"
                                  disabled>
                              </ng-template>
                            </ngx-datatable-column>
                          </aaa-grid>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </div>
              </div>
            </card>
            <br />
          </tab>
          <tab heading="{{ 'Label.LOTS03.printContract'| translate }}" (select)="tabSelected(7)">
            <br>
            <div class="form-row">
              <div class="form-group col-12 col-sm-5 col-md-5" style="border-right: dashed;">
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.RF02'| translate }} :</strong> <strong style="color: red;">{{
                      'Label.LOTS03.PrintFrontBack'| translate }}</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf02()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.RF09'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf09()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.RF06'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf06()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row" *ngIf="loanAgreementForm.controls.ContractType.value == 'M'">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.LoanPeriodTable'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintLoanPeriodTable('pdf')">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                    <!-- <button class="btn btn-sm btn-primary" (click)="onPrintLoanPeriodTable('pdf')"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button> -->
                    <!-- <button class="btn btn-sm btn-primary" (click)="onPrintLoanPeriodTable('xlsx')"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.ExportToExcel'| translate }}
                    </button> -->
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.Consent'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintConsent()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.barCode'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintQrBar('pdf')">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.Map'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf18()">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <div class="form-row" style="border-bottom: dashed">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'Label.LOTS03.MemorandumAgreementAttached '| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf19()">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <br />
                <div class="form-row" *ngIf="loanAgreementForm.controls.ContractType.value == 'M'">
                  <div class="form-group col-12 col-sm-12 col-md-12">
                    <b>{{ 'เอกสารเพิ่มเติม - ประกันสินเชื่อสบายใจ'| translate }}</b>
                  </div>
                </div>
                <div class="form-row" *ngIf="loanAgreementForm.controls.ContractType.value == 'M'"
                  style="margin-bottom: -15px;border-bottom: dashed">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong>{{ 'ใบคำขอข้อมูลสินเชื่อสบายใจ'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-2 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintApplicationFormInsurance()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                </div>
                <!-- <div class="form-row" *ngIf="loanAgreementForm.controls.ContractType.value == 'M'">
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <strong style="color: red;">{{'Label.LOTS03.PrintFrontBack'| translate }}</strong>
                  </div>
                </div> -->
              </div>
              <div class="form-group col-12 col-sm-6 col-md-6">
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-12 col-md-12">
                    <b>{{ 'Label.LOTS03.AdditionalDocumentsProvince'| translate }}</b>
                  </div>
                </div>
                <div class="form-row" *ngIf="loanAgreementForm.controls.ContractType.value == 'M'"
                  style="border-bottom: dashed;padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.CertificateAddress'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintCertificateAddress()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.Print'| translate }}
                    </button>
                  </div>
                  <!-- <div class="form-group col-12 col-sm-6 col-md-2">
                    <button class="btn btn-sm btn-primary" (click)="onPrintCertificateAddress(2)"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true">
                      {{ 'Label.LOTS03.PrintBorrower'| translate }}
                    </button>
                  </div> -->
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-12 col-md-12">
                    <b>{{ 'Label.LOTS03.AdditionalDocumentsMortgage'| translate }}</b>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.PaymentVoucher'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintPaymentVoucher()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true && !IsAccountingUser">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="border-bottom: dashed;padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.ReceiptVoucher'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintReceiptVoucher()"
                      [disabled]="loanAgreementForm.controls.IsDisableAttachment.value == true && !IsAccountingUser">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-12 col-md-12">
                    <b>{{ 'Label.LOTS03.AdditionalDocumentsCars'| translate }}</b>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.CarPurchaseAgreement'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf13()">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.MotorcyclePurchaseAgreement'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf12()">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.HirePurchaseContract'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf14()">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.PowerOfAttorney'| translate }} :</strong> <strong style="color: red;">{{
                      'Label.LOTS03.PrintFrontBack'| translate }}</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf17()">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.RequestTransfer'| translate }} :</strong> <strong style="color: red;">{{
                      'Label.LOTS03.PrintFrontBack'| translate }}</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf15()">
                      พิมพ์
                    </button>
                  </div>
                </div>
                <div class="form-row" style="padding-left: 2%;">
                  <div class="form-group col-12 col-sm-5 col-md-5">
                    <strong>{{ 'Label.LOTS03.Letter'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-6 col-md-6">
                    <button class="btn btn-sm btn-primary" (click)="onPrintRf16()">
                      พิมพ์
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </tab>
          <tab heading="{{ 'Label.LOTS03.attachment'| translate }}" (select)="tabSelected(8)">
            <card header="{{ 'Label.LOTS03.attachment'| translate }}">
              <div class="card-menu">
                <button *ngIf="IsSuperUser" type="button" (click)="onApproveSecurityCustomer()"
                  class="btn btn-sm btn-success">
                  อนุมัติให้ดูข้อมูลลูกค้า
                </button>
                <button
                  *ngIf="loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S'"
                  type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachment()">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12" formArrayName="contractAttachments">
                    <aaa-grid #detailgrid [rows]="contractAttachments.getRawValue()" [formArray]="contractAttachments">
                      <ngx-datatable-column name="AttachmentTypeCode">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper require">{{'Label.LOTS03.attachmentTypeCode'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          <div [formGroupName]="rowIndex">
                            <ng-select class="sm" appendTo="body" dropdownPosition="bottom" [items]="attachmentTypes"
                              [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                              (open)="filterAttachmentTypes(row.ContractAttachmentId)"
                              formControlName="AttachmentTypeCode"
                              placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                            </ng-select>
                            <div class="invalid-feedback">
                              {{ 'Message.STD00000' | translate }}
                            </div>
                          </div>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column name="FileName">
                        <ng-template ngx-datatable-header-template>
                          <label class="require">{{ 'Label.LOTS03.attachment'| translate
                            }}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          <div [formGroupName]="rowIndex">
                            <file-upload-auto [file]="attachmentFiles[rowIndex]"
                              [fileName]="contractAttachments.getRawValue()[rowIndex].FileName" [category]="category"
                              [isDisableDownload]="contractAttachments.getRawValue()[rowIndex].IsDisableAttachment"
                              (fileNameReturn)="fileNameReturn($event, rowIndex)" formControlName="AttahmentId">
                            </file-upload-auto>
                          </div>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column>
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.Description'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                          ngx-datatable-cell-template>
                          <div [formGroupName]="rowIndex">
                            <input type="text" class="form-control form-control-sm" formControlName="Description">
                          </div>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [cellClass]="'text-center'" name="CopyDocRefinance">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">ทำสำเนาเอกสารรีไฟแนนซ์</label>
                        </ng-template>
                        <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                          <div [formGroupName]="rowIndex">
                            <label class="datatable-checkbox">
                              <input type="checkbox" formControlName="CopyDocRefinance">
                            </label>
                          </div>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [cellClass]="'text-center'" width="50">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                          <button class="btn btn-outline-primary btn-sm" (click)="removeAttachment(rowIndex);"
                            [disabled]="((loanAgreementForm.controls.ContractStatus.value != 'N' && loanAgreementForm.controls.ContractStatus.value != 'AC') && row.RowState != '1') || row.IsSignature">
                            <i class="far fa-trash-alt"></i>
                          </button>
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-grid>
                  </div>
                </div>
              </div>
            </card>
          </tab>
          <tab heading="{{ 'Label.LOTS03.DunningHistory'| translate }}" (select)="tabSelected(9)">
            <tabset>
              <tab heading="{{ 'Label.LOTS03.CurrentStatus'| translate }}" (select)="tabSelected(91)">
                <div class="form-row">
                  <div class="form-group col-12 col-sm-3 col-md-3">
                    <strong>{{ 'Label.LOTS03.Status'| translate }}
                      {{ 'Label.LOTS03.StatusDebtCollection'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-9 col-md-9">
                    <label>{{ loanAgreementForm.controls.CallTrackingStatusDisplay.value }}</label>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-3 col-md-3">
                    <strong>{{ 'Label.LOTS03.Status'| translate }}
                      {{ 'Label.LOTS03.StatusTrackHome'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-9 col-md-9">
                    <label>{{ loanAgreementForm.controls.HomeTrackingStatusDisplay.value }}</label>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-3 col-md-3">
                    <strong>{{ 'Label.LOTS03.Status'| translate }}
                      {{ 'Label.LOTS03.StatusTrackHomeNPL'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-9 col-md-9">
                    <label>{{ loanAgreementForm.controls.NplTrackingStatusDisplay.value }}</label>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-12 col-sm-3 col-md-3">
                    <strong>{{ 'Label.LOTS03.Status'| translate }}
                      {{ 'Label.LOTS03.StatusLawDepartment'| translate }} :</strong>
                  </div>
                  <div class="form-group col-12 col-sm-9 col-md-9">
                    <label>{{ loanAgreementForm.controls.LawTrackingStatusDisplay.value }}</label>
                  </div>
                </div>
                <card header="{{ 'ปรวัติการส่ง SMS'| translate}}">
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="smsHis" [page]="pageSms" (onTableEvent)="onTableEventSmsHis($event)">
                          <ngx-datatable-column width="10" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template prop="CreatedDate">
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'วันที่' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="10" [cellClass]="'text-center'" prop="LogSmsType">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'ประเภท SMS'}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.LogSmsType }}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="LogSmsMessage">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'ข้อความ'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.LogSmsMessage}}
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
              <tab heading="{{ 'Label.LOTS03.HistoryDebtCollection'| translate }}" (select)="tabSelected(92)">
                <card header="{{ 'Label.LOTS03.Description'| translate}}">
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="callHis" [page]="pageCall" (onTableEvent)="onTableEventCallHis($event)">
                          <ngx-datatable-column width="30" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'Label.LOTS03.No.' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.RowNum}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingDate | thaidate}}
                              <label *ngIf="row.TrackingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.MeetingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.MeetingDate | thaidate}}
                              <label *ngIf="row.MeetingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="TrackingItemNameTha">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingItemName'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row['TrackingItemName'+lang.CURRENT]}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="180" [cellClass]="'text-left'" prop="Remark">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.Remark}}
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
                <br />
                <card header="{{ 'เอกสารแนบ (โทรติดตามหนี้)'| translate }}">
                  <div class="card-menu">
                    <button
                      *ngIf="(loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F') && this.callHis.length > 0"
                      type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachmentCall()">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractAttachmentsCall">
                        <aaa-grid #detailgrid [rows]="contractAttachmentsCall.getRawValue()"
                          [formArray]="contractAttachmentsCall">
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'วันที่/เวลา' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate: 'datetime'}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'พนักงานที่แนบเอกสาร' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedBy}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column name="FileName">
                            <ng-template ngx-datatable-header-template>
                              <label class="require">{{ 'Label.LOTS03.attachment'| translate
                                }}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <file-upload-auto [file]="attachmentFilesCall[rowIndex]"
                                  [fileName]="contractAttachmentsCall.getRawValue()[rowIndex].FileName"
                                  [category]="categoryTracking" [isDisableDownload]="false"
                                  (fileNameReturn)="fileNameReturnCall($event, rowIndex)" formControlName="AttahmentId">
                                </file-upload-auto>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="50">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeAttachmentCall(rowIndex);" [disabled]="isDisableAttachment">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
              <tab heading="{{ 'Label.LOTS03.HistoryTrackingHome' | translate}}" (select)="tabSelected(93)">
                <card header="{{ 'Label.LOTS03.Description'| translate}}">
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="comHis" [page]="pageCom" (onTableEvent)="onTableEventComHis($event)">
                          <ngx-datatable-column width="30" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'Label.LOTS03.No.' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.RowNum}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingDate | thaidate}}
                              <label *ngIf="row.TrackingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="MeetingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.MeetingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.MeetingDate | thaidate}}
                              <label *ngIf="row.MeetingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingHome">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingHome'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingHome | thaidate}}
                              <label *ngIf="row.TrackingHome==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="TrackingItemNameTha">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingItemName'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingItemNameTha}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="180" [cellClass]="'text-left'" prop="Remark">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.Remark}}
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
                <br />
                <card header="{{ 'เอกสารแนบ (ติดตามที่บ้าน(บริษัท))'| translate }}">
                  <div class="card-menu">
                    <button
                      *ngIf="(loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F') && this.comHis.length > 0"
                      type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachmentHome()">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractAttachmentsHome">
                        <aaa-grid #detailgrid [rows]="contractAttachmentsHome.getRawValue()"
                          [formArray]="contractAttachmentsHome">
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'วันที่/เวลา' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate: 'datetime'}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'พนักงานที่แนบเอกสาร' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedBy}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column name="FileName">
                            <ng-template ngx-datatable-header-template>
                              <label class="require">{{ 'Label.LOTS03.attachment'| translate
                                }}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <file-upload-auto [file]="attachmentFilesHome[rowIndex]"
                                  [fileName]="contractAttachmentsHome.getRawValue()[rowIndex].FileName"
                                  [category]="categoryTracking" [isDisableDownload]="false"
                                  (fileNameReturn)="fileNameReturnHome($event, rowIndex)" formControlName="AttahmentId">
                                </file-upload-auto>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="50">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeAttachmentHome(rowIndex);" [disabled]="isDisableAttachment">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
              <tab heading="{{ 'Label.LOTS03.HistoryTrackingHomeNPL' | translate}}" (select)="tabSelected(94)">
                <card header="{{ 'Label.LOTS03.Description'| translate}}">
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="nplHis" [page]="pageNpl" (onTableEvent)="onTableEventLawHis($event)">
                          <ngx-datatable-column width="30" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'Label.LOTS03.No.' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.RowNum}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingDate | thaidate}}
                              <label *ngIf="row.TrackingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="MeetingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.MeetingDate'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.MeetingDate | thaidate}}
                              <label *ngIf="row.MeetingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingHomeNpl">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingHomeNpl'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingHomeNpl | thaidate}}
                              <label *ngIf="row.TrackingHomeNpl==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="TrackingItemNameTha">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.TrackingItemName'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingItemNameTha}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="180" [cellClass]="'text-left'" prop="Remark">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.Remark}}
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
                <br />
                <card header="{{ 'เอกสารแนบ (ติดตามที่บ้าน(Npl))'| translate }}">
                  <div class="card-menu">
                    <button
                      *ngIf="(loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F') && this.nplHis.length > 0"
                      type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachmentNpl()">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractAttachmentsNpl">
                        <aaa-grid #detailgrid [rows]="contractAttachmentsNpl.getRawValue()"
                          [formArray]="contractAttachmentsNpl">
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'วันที่/เวลา' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate: 'datetime'}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'พนักงานที่แนบเอกสาร' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedBy}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column name="FileName">
                            <ng-template ngx-datatable-header-template>
                              <label class="require">{{ 'Label.LOTS03.attachment'| translate
                                }}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <file-upload-auto [file]="attachmentFilesNpl[rowIndex]"
                                  [fileName]="contractAttachmentsNpl.getRawValue()[rowIndex].FileName"
                                  [category]="categoryTracking" [isDisableDownload]="false"
                                  (fileNameReturn)="fileNameReturnNpl($event, rowIndex)" formControlName="AttahmentId">
                                </file-upload-auto>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="50">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeAttachmentNpl(rowIndex);" [disabled]="isDisableAttachment">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
              <tab heading="{{'ประวัติการติดตาม (Law Department)' | translate}}" (select)="tabSelected(95)">
                <card header="{{ 'Label.TRTS02.Detail'| translate}}">
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="lawHis" [page]="pageLaw" (onTableEvent)="onTableEventLawHis($event)">
                          <ngx-datatable-column width="30" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'Label.TRTS01.Count' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.RowNum}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper"
                                (click)="sort()">{{'Label.TRTS01.TrackingDate' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingDate | thaidate}}
                              <label *ngIf="row.TrackingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="60" [cellClass]="'text-center'" prop="TrackingDate">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'Label.TRTS01.MeetingDate'
                                |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.MeetingDate | thaidate}}
                              <label *ngIf="row.MeetingDate==null">-</label>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="TrackingItemNameTha">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper"
                                (click)="sort()">{{'Label.TRTS01.StatusTracking'
                                | translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingItemNameTha}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="180" [cellClass]="'text-left'" prop="Remark">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'Label.TRTS01.Remark' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.Remark}}
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
                <br />
                <card header="{{ 'เอกสารแนบ (ติดตามสำหรับ Law Department)'| translate }}">
                  <div class="card-menu">
                    <button
                      *ngIf="(loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F') && this.lawHis.length > 0"
                      type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachmentLaw()">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractAttachmentsLaw">
                        <aaa-grid #detailgrid [rows]="contractAttachmentsLaw.getRawValue()"
                          [formArray]="contractAttachmentsLaw">
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'วันที่/เวลา' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate: 'datetime'}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'พนักงานที่แนบเอกสาร' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedBy}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column name="FileName">
                            <ng-template ngx-datatable-header-template>
                              <label class="require">{{ 'Label.LOTS03.attachment'| translate
                                }}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <file-upload-auto [file]="attachmentFilesLaw[rowIndex]"
                                  [fileName]="contractAttachmentsLaw.getRawValue()[rowIndex].FileName"
                                  [category]="categoryTracking" [isDisableDownload]="false"
                                  (fileNameReturn)="fileNameReturnLaw($event, rowIndex)" formControlName="AttahmentId">
                                </file-upload-auto>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="50">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeAttachmentLaw(rowIndex);" [disabled]="isDisableAttachment">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
              <!-- <tab heading="{{ 'ค่าใช้จ่ายติดตามหนี้'| translate }}" (select)="tabSelected(96)" *ngIf="IsSuperUser"> -->
              <tab heading="{{ 'ค่าใช้จ่ายติดตามหนี้'| translate }}" (select)="tabSelected(96)">
                <card header="{{ 'ประวัติการบันทึกค่าใช้จ่ายติดตามหนี้'| translate}}">
                  <div class="card-menu">
                    <button type="button" class="btn btn-sm btn-circle btn-secondary"
                      *ngIf="loanAgreementForm.controls.ContractStatus.value == 'AP' || loanAgreementForm.controls.ContractStatus.value == 'P'"
                      (click)="openDebtCollectionExpenses(debtCollectionExpenses,null)"
                      tooltip="{{ 'Label.GLOBAL.Add' | translate }}">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="row">
                      <div class="col-md-12">
                        <aaa-table [rows]="debtCollectionExpensesList" [page]="pageDebtCollectionExpenses"
                          (onTableEvent)="onTableEventDebtCollectionExpenses($event)">
                          <ngx-datatable-column width="10" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template prop="TrackingDate">
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'วันที่' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.TrackingDate | thaidate}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="10" [cellClass]="'text-center'" prop="StatusDescTha">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'สถานะ'}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.StatusDescTha }}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-right'" prop="MoveRefinanceAmount">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'ค่าใช้จ่ายในการย้ายไฟแนนซ์'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.MoveRefinanceAmount | number:0}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="110" [cellClass]="'text-left'" prop="Remark">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                'หมายเหตุ'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.Remark}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="80" [cellClass]="'text-center'">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{ 'แก้ไข'| translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              <button class="btn btn-sm" class="btn btn-outline-primary btn-sm"
                                (click)="openDebtCollectionExpenses(debtCollectionExpenses,row)"
                                [disabled]="loanAgreementForm.controls.ContractStatus.value != 'AP' && loanAgreementForm.controls.ContractStatus.value != 'P'">
                                <i class="fas fa-pencil-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-table>
                      </div>
                    </div>
                  </div>
                </card>
                <card header="{{ 'เอกสารแนบ (ค่าใช้จ่ายติดตามหนี้)'| translate }}">
                  <div class="card-menu">
                    <button
                      *ngIf="(loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F') && this.debtCollectionExpensesList.length > 0"
                      type="button" class="btn btn-sm btn-circle btn-secondary" (click)="addAttachmentOther()">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="card-content">
                    <div class="form-row">
                      <div class="col-12" formArrayName="contractAttachmentsOther">
                        <aaa-grid #detailgrid [rows]="contractAttachmentsOther.getRawValue()"
                          [formArray]="contractAttachmentsOther">
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'วันที่/เวลา' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedDate | thaidate: 'datetime'}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column width="100" [cellClass]="'text-center'" [sortable]="false">
                            <ng-template let-sort="sortFn" ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper" (click)="sort()">{{'พนักงานที่แนบเอกสาร' |
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" ngx-datatable-cell-template>
                              {{row.CreatedBy}}
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column name="FileName">
                            <ng-template ngx-datatable-header-template>
                              <label class="require">{{ 'Label.LOTS03.attachment'| translate
                                }}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <file-upload-auto [file]="attachmentFilesOther[rowIndex]"
                                  [fileName]="contractAttachmentsOther.getRawValue()[rowIndex].FileName"
                                  [category]="category" [isDisableDownload]="false"
                                  (fileNameReturn)="fileNameReturnOther($event, rowIndex)"
                                  formControlName="AttahmentId">
                                </file-upload-auto>
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column>
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{
                                'Label.LOTS03.Description'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                              ngx-datatable-cell-template>
                              <div [formGroupName]="rowIndex">
                                <input type="text" class="form-control form-control-sm" formControlName="Description">
                              </div>
                            </ng-template>
                          </ngx-datatable-column>
                          <ngx-datatable-column [cellClass]="'text-center'" width="50">
                            <ng-template ngx-datatable-header-template>
                              <label class="datatable-header-cell-wrapper">{{'Label.GLOBAL.Delete'|
                                translate}}</label>
                            </ng-template>
                            <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                              <button type="button" class="btn btn-outline-primary btn-sm"
                                (click)="removeAttachmentOther(rowIndex);" [disabled]="isDisableAttachment">
                                <i class="far fa-trash-alt"></i>
                              </button>
                            </ng-template>
                          </ngx-datatable-column>
                        </aaa-grid>
                      </div>
                    </div>
                  </div>
                </card>
              </tab>
            </tabset>
          </tab>
          <tab heading="{{ 'Label.LOTS03.informationCard'| translate }}" (select)="tabSelected(10)">
            <card header="{{ 'Label.LOTS03.informationCard'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-md-12">
                    <div formArrayName="contractInformations">
                      <div class="custom-control custom-checkbox custom-control-inline" (change)="onChange()"
                        *ngFor="let item of contractInformations.controls; let i=index" [formGroupName]="i">
                        <input class="custom-control-input" type="checkbox" [id]="'Chkinformations'+ i"
                          formControlName="Active">
                        <label class="custom-control-label" [for]="'Chkinformations'+ i">
                          {{ item.controls['Text'+lang.CURRENT].value }}
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
                <div *ngIf="addOn" class="form-row">
                  <div class="form-group col-md-4">
                    <label>{{ 'Label.LOTS04.AdditionalLoan'| translate}}</label>
                    <ngx-numeric-textbox inputClass="form-control form-control" formControlName="AddOn" [decimals]="0">
                    </ngx-numeric-textbox>
                    <div class="invalid-feedback" *ngIf="loanAgreementForm.controls.AddOn.invalid">
                      <div *ngIf="loanAgreementForm.controls.AddOn.errors.required">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                      <div *ngIf="loanAgreementForm.controls.AddOn.errors.min">
                        {{ 'Message.LO00004' | translate }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card header="{{ 'MGM'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-md-2 col-sm-2 col-2">
                    <div class="custom-control custom-checkbox">
                      <input class="custom-control-input" type="checkbox" id="Active" formControlName="MGMCheckbox">
                      <label class="custom-control-label" for="Active">
                        {{'MGM'| translate}}
                      </label>
                      <div class="invalid-feedback">
                        {{ 'Message.STD00000' | translate }}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-4 col-sm-4 col-12">
                    <label class="require">{{'Label.LOTS04.Activity'| translate }}</label>
                    <input type="text" class="form-control" formControlName="Activity" maxlength="100">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6 col-sm-6 col-6">
                    <card header="{{ 'Label.LOTS04.Employee'| translate }}">
                      <div class="card-content">
                        <div class="form-row">
                          <div class="col-12">
                            <aaa-grid-no-pager #ContractMgmEmployeeGrid [rows]="ContractMgmEmployee.getRawValue()"
                              [formArray]="ContractMgmEmployee">
                              <ngx-datatable-column [width]="20" [sortable]="false" [cellClass]="'text-center'">
                                <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'Label.LOTS04.No'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                  ngx-datatable-cell-template>
                                  {{rowIndex+1}}
                                </ng-template>
                              </ngx-datatable-column>
                              <ngx-datatable-column [width]="60" [sortable]="false" [cellClass]="'text-center'">
                                <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                    'Label.LOTS04.EmployeeCode'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                  ngx-datatable-cell-template>
                                  {{ row.EmployeeCode }}
                                </ng-template>
                              </ngx-datatable-column>
                              <ngx-datatable-column [width]="200" prop="EmployeeName{{lang.CURRENT}}"
                                [sortable]="false">
                                <ng-template ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper">{{
                                    'Label.LOTS04.FirstLastName'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                  ngx-datatable-cell-template>
                                  {{ row['EmployeeName'+lang.CURRENT]}}
                                </ng-template>
                              </ngx-datatable-column>
                            </aaa-grid-no-pager>
                          </div>
                        </div>
                      </div>
                    </card>
                  </div>
                  <div class="form-group col-md-6 col-sm-6 col-6">
                    <card header="{{ 'Label.LOTS04.MGM'| translate }}">
                      <div class="card-content">
                        <div class="form-row">
                          <div class="col-12">
                            <aaa-grid-no-pager #ContractMgmGrid [rows]="ContractMgm.getRawValue()"
                              [formArray]="ContractMgm">
                              <ngx-datatable-column [width]="20" [sortable]="false" [cellClass]="'text-center'">
                                <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper" (click)="sort()">{{ 'Label.LOTS04.No'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                  ngx-datatable-cell-template>
                                  {{rowIndex+1}}
                                </ng-template>
                              </ngx-datatable-column>
                              <ngx-datatable-column [width]="40" prop="MgmName{{lang.CURRENT}}"
                                [cellClass]="'text-left'">
                                <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                    'Label.LOTS04.MgmCode'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" ngx-datatable-cell-template>
                                  <span> {{row.MgmCode}}</span>
                                </ng-template>
                              </ngx-datatable-column>
                              <ngx-datatable-column [width]="40" prop="MgmName{{lang.CURRENT}}"
                                [cellClass]="'text-left'">
                                <ng-template let-sort="sortFn" ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                                    'Label.LOTS04.CustomerCode1'|
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" ngx-datatable-cell-template>
                                  <span> {{row.CustomerCode}}</span>
                                  <i *ngIf="!row.CustomerCode" class="fas fa-minus"></i>
                                </ng-template>
                              </ngx-datatable-column>
                              <ngx-datatable-column [width]="200" prop="EmployeeName{{lang.CURRENT}}"
                                [sortable]="false">
                                <ng-template ngx-datatable-header-template>
                                  <label class="datatable-header-cell-wrapper">{{
                                    'Label.LOTS04.FirstLastName' |
                                    translate}}</label>
                                </ng-template>
                                <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex"
                                  ngx-datatable-cell-template>
                                  {{ row['MgmName'+lang.CURRENT]}}
                                </ng-template>
                              </ngx-datatable-column>
                            </aaa-grid-no-pager>
                          </div>
                        </div>
                      </div>
                    </card>
                  </div>
                </div>
              </div>
            </card>
            <br />
            <card header="{{ 'Label.LOTS03.Remark'| translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="form-group col-12">
                    <textarea formControlName="DescLoan" id="textarea-input" name="textarea-input" rows="7"
                      class="form-control" placeholder=""></textarea>
                  </div>
                </div>
              </div>
            </card>
          </tab>
          <tab heading="{{ 'Label.LOTS03.ContractPolicy'| translate }}" (select)="tabSelected(11)"
            *ngIf="loanAgreementForm.controls.ContractType.value == 'M'">
            <card header="{{ 'Label.LOTS03.ContractPolicy'| translate }}">
              <div class="card-menu">
                <button *ngIf="loanAgreementForm.controls.editStatus.value !== '1'" type="button"
                  class="btn btn-sm btn-circle btn-secondary" (click)="addPolicy(null, addPolicyModal)">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12">
                    <aaa-table [rows]="contractPolicys" [page]="pageContracPolicy"
                      (onTableEvent)="onTableEventContractPolicys($event)">
                      <ngx-datatable-column [width]="200" prop="PolicyNameTha">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.Policy'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row['PolicyName'+lang.CURRENT]}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="60" prop="PolicyPeriod" [cellClass]="'text-center'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'จำนวน'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.PolicyPeriod}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="60" prop="PolicyDate" [cellClass]="'text-center'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'วันที่เริ่ม'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.PolicyDate | thaidate }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="60" prop="PolicyEndDate" [cellClass]="'text-center'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'วันที่สิ้นสุด'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.PolicyEndDate | thaidate }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="100" prop="PolicyRemark">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'Label.LOTS03.Remark'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.PolicyRemark}}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [cellClass]="'text-center'" [sortable]="false" width="50">
                        <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                          <button type="button" class="btn btn-outline-primary btn-sm" *ngIf="row.IsCanDeletePolicy"
                            (click)="removeContractPolicy(row)">
                            <i class="far fa-trash-alt"></i>
                          </button>
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-table>
                  </div>
                </div>
              </div>
            </card>
          </tab>
          <!-- <tab heading="{{ 'รายละเอียดการรับชำระ'| translate }}" (select)="tabSelected(12)"
            *ngIf="loanAgreementForm.controls.ContractType.value == 'M' && IsCancelReceiptUser"> -->
          <tab heading="{{ 'รายละเอียดการรับชำระ'| translate }}" (select)="tabSelected(12)"
            *ngIf="loanAgreementForm.controls.ContractType.value == 'M' && IsSuperUser && username == 'softsquare'">
            <card header="{{ 'รายละเอียดการรับชำระ'| translate }}">
              <div class="card-menu">
                <button type="button" (click)="onSearchContractProcess()" class="btn btn-sm btn-circle btn-secondary"
                  tooltip="ค้นหา">
                  <i class="fas fa-search"></i>
                </button>
                <button *ngIf="contractProcessLists.length == 0" type="button" (click)="initialProcess()"
                  class="btn btn-sm btn-success">
                  Initail Process
                </button>
                <button type="button" (click)="duedateProcess()" class="btn btn-sm btn-warning">
                  Due date
                </button>
              </div>
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12">
                    <aaa-grid-no-pager [rows]="contractProcessLists">
                      <ngx-datatable-column [width]="200" prop="MainContractTransactionDate"
                        [cellClass]="'text-center'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{ 'วันที่ทำรายการ'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.MainContractTransactionDate | thaidate }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="100" prop="ReceiptNo" [cellClass]="'text-center'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{
                            'เลขที่ใบเสร็จรับเงิน'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          <span class="link"
                            (click)="linkReceiptDetail(row.ReceiptHeadId, row.DocumentType)">{{row.ReceiptNo}}</span>
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="100" prop="ReceiptTotalAmount" [cellClass]="'text-right'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{ 'จำนวนเงิน'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          {{row.ReceiptTotalAmount | number:0 }}
                        </ng-template>
                      </ngx-datatable-column>
                      <ngx-datatable-column [cellClass]="'text-center'" width="50">
                        <ng-template ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper">{{ 'ยกเลิก'|
                            translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                          <button type="button" class="btn btn-danger btn-sm" *ngIf="row.CanDelete"
                            (click)="openRemoveContractProcessPopup(removeContractProcess, row)">
                            ยกเลิก
                          </button>
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-grid-no-pager>
                  </div>
                </div>
              </div>
            </card>
          </tab>
        </tabset>
      </form>
    </div>
  </div>
</div>

<ng-template #addEmployeeModal>
  <modal-layout (onClose)="closeMgmEmployeeModal(true)" header="{{ 'จัดการพนักงาน' | translate }}">
    <form [formGroup]="searchEmpForm" [class.validated]="submitted" [focusInvalid]="focusToggle">
      <div class="animated fadeIn">
        <div class="row">
          <div class="col-sm-12">
            <card header="{{ 'ค้นหา' | translate }}">
              <div class="card-menu">
                <button type="button" class="btn btn-sm btn-circle btn-secondary"
                  tooltip="{{'Label.GLOBAL.Search' | translate}}" (click)="searchEmployeeModal()">
                  <i class="fas fa-search"></i>
                </button>
              </div>
              <div class="card-content">
                <div class="row">
                  <div class="col-sm-6">
                    <label class="require">{{'ชื่อพนักงาน'| translate}}</label>
                    <input type="text" class="form-control text-left" formControlName="EmployeeName" maxlength="50"
                      placeholder="{{ 'ชื่อพนักงาน' | translate }}" (keyup.enter)="searchEmployeeModal()">
                  </div>
                </div>
              </div>
            </card>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-sm-12">
            <card header="{{ 'เพิ่มพนักงาน' | translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12">
                    <aaa-table [rows]="getEmployeeList" [rowSelect]="attributeSelected" [page]="pageEmployee"
                      (onTableEvent)="onTableEvent($event)">
                      <ngx-datatable-column [width]="50" [sortable]="false" [canAutoResize]="false" [draggable]="false"
                        [resizeable]="false" [headerCheckboxable]="true" [checkboxable]="true">>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="150" prop="EmployeeName{{lang.CURRENT}}" [cellClass]="'text-left'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                            'ชื่อ - สกุล'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          <span> {{row['EmployeeName'+lang.CURRENT]}}</span>
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-table>
                  </div>
                </div>
              </div>
            </card>
          </div>
        </div>
      </div>
    </form>
    <div class="container-fluid ">
      <div class="row" style="background-color: #005fb7;">
        <div class="col text-center" (click)="genEmployee()">
          <button class="btn btn-footer" style="color: white;">
            <i class="fas fa-plus"></i> {{ 'เพิ่ม' | translate }}</button>
        </div>
      </div>
    </div>
  </modal-layout>
</ng-template>

<ng-template #addMgmModal>
  <modal-layout (onClose)="closeMgmModal(true)" header="{{ 'จัดการMGM' | translate }}">
    <form [formGroup]="searchMgmForm" [class.validated]="submitted" [focusInvalid]="focusToggle">
      <div class="animated fadeIn">
        <div class="row">
          <div class="col-sm-12">
            <card header="{{ 'ค้นหา' | translate }}">
              <div class="card-menu">
                <button type="button" class="btn btn-sm btn-circle btn-secondary"
                  tooltip="{{'Label.GLOBAL.Search' | translate}}" (click)="searchMgmModal()">
                  <i class="fas fa-search"></i>
                </button>
              </div>
              <div class="card-content">
                <div class="row">
                  <div class="col-sm-6">
                    <label class="require">{{'ชื่อผู้แนะนำ'| translate}}</label>
                    <input type="text" class="form-control text-left" formControlName="MgmName" maxlength="50"
                      placeholder="{{ 'ชื่อผู้แนะนำ' | translate }}" (keyup.enter)="searchMgmModal()">
                  </div>
                </div>
              </div>
            </card>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-sm-12">
            <card header="{{ 'เพิ่มMGM' | translate }}">
              <div class="card-content">
                <div class="form-row">
                  <div class="col-12">
                    <aaa-table [rows]="getMgmList" [rowSelect]="attributeSelected" [page]="pageMgm"
                      (onTableEvent)="onTableMgmEvent($event)">
                      <ngx-datatable-column [width]="50" [sortable]="false" [canAutoResize]="false" [draggable]="false"
                        [resizeable]="false" [headerCheckboxable]="true" [checkboxable]="true">>
                      </ngx-datatable-column>
                      <ngx-datatable-column [width]="150" prop="MgmName{{lang.CURRENT}}" [cellClass]="'text-left'">
                        <ng-template let-sort="sortFn" ngx-datatable-header-template>
                          <label class="datatable-header-cell-wrapper" (click)="sort()">{{
                            'ชื่อ - สกุล'| translate}}</label>
                        </ng-template>
                        <ng-template let-row="row" ngx-datatable-cell-template>
                          <span> {{row['MgmName'+lang.CURRENT]}}</span>
                        </ng-template>
                      </ngx-datatable-column>
                    </aaa-table>
                  </div>
                </div>
              </div>
            </card>
          </div>
        </div>
      </div>
    </form>
    <div class="container-fluid ">
      <div class="row" style="background-color: #005fb7;">
        <div class="col text-center" (click)="genMgm()">
          <button class="btn btn-footer" style="color: white;">
            <i class="fas fa-plus"></i> {{ 'เพิ่ม' | translate }}</button>
        </div>
      </div>
    </div>
  </modal-layout>
</ng-template>

<footer class="app-footer-btn animated fadeIn">
  <div class="container-fluid">
    <div class="row">
      <div
        *ngIf="loanAgreementForm.controls.editStatus.value !== '1' || loanAgreementForm.controls.ContractStatus.value == 'S' || loanAgreementForm.controls.ContractStatus.value == 'F'"
        class="col text-center">
        <button class="btn btn-footer" (click)="onSubmit()" [disabled]="saving">
          <i class="fas fa-cog fa-spin" [hidden]="!saving"></i>
          <i class="far fa-save" [hidden]="saving"></i> {{'Label.GLOBAL.Save' | translate}}</button>
      </div>
      <div
        *ngIf="loanAgreementForm.controls.ContractType.value == 'M' && loanAgreementForm.controls.ContractStatus.value == 'N'"
        class="col text-center">
        <button class="btn btn-footer" (click)="onCancel()" [disabled]="cancelStatus">
          <i class="fas fa-cog fa-spin" [hidden]="!cancelStatus"></i>
          <i class="fas fa-ban" [hidden]="cancelStatus"></i> {{'Label.GLOBAL.Cancel' | translate}}</button>
      </div>
      <div *ngIf="loanAgreementForm.controls.ContractStatus.value == 'PF' && contractHead.RefinanceReqType == 'W'"
        class="col text-center">
        <button class="btn btn-footer" (click)="onCancelRefinance()" [disabled]="cancelRefinance">
          <i class="fas fa-cog fa-spin" [hidden]="!cancelRefinance"></i>
          <i class="fas fa-ban" [hidden]="cancelRefinance"></i>
          {{'Label.LOTS03.CancelPreRefinance' | translate}}</button>
      </div>
      <!-- <div
        *ngIf="IsSuperUser && IsCompanyCapital && (loanAgreementForm.controls.ContractStatus.value == 'AP' || loanAgreementForm.controls.ContractStatus.value == 'P') && AllContractReceivePeriod.length == 0"
        class="col text-center">
        <button class="btn btn-footer" (click)="onCancelContractCapital()" [disabled]="cancelContractCapital">
          <i class="fas fa-cog fa-spin" [hidden]="!cancelContractCapital"></i>
          <i class="fas fa-ban" [hidden]="cancelContractCapital"></i>
          {{'Label.LOTS03.CancelContractCapital' | translate}}</button>
      </div> -->
      <div class="col text-center">
        <button class="btn btn-footer" [disabled]="saving" (click)="back()">
          <i class="fas fa-undo-alt"></i> {{'Label.GLOBAL.Back' | translate}}</button>
      </div>
    </div>
  </div>
</footer>

<ng-template #addPolicyModal>
  <modal-layout (onClose)="close()" header="{{ 'Label.LOTS03.ContractPolicy' | translate }}">
    <form [formGroup]="policyPeriodForm" [class.validated]="submitted" [focusInvalid]="focusToggle">
      <div class="form-row">
        <div class="form-group col-sm-9 col-md-6">
          <label class="require">{{ 'Label.LOTS03.ContractPolicyCode'| translate }}</label>
          <ng-select [items]="ContractPolicyList" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
            formControlName="PolicyCode">
          </ng-select>
          <div class="invalid-feedback">
            {{ 'Message.STD00000' | translate }}
          </div>
        </div>
      </div>
      <hr>
      <div class="form-row">
        <div class="form-group col-sm-6 col-md-4">
          <label class="require">{{ 'Label.LOTS03.PolicyDate'| translate}}</label>
          <input bsDatepicker class="form-control" type="text" formControlName="PolicyDate" />
        </div>
      </div>
      <div class="form-row" *ngIf="policyPeriodForm.controls.ContractPolicyId.value == null">
        <div class="form-group col-sm-9 col-md-6">
          <label class="require">{{ 'Label.LOTS03.PolicyPeriod'| translate }}</label>
        </div>
        <div class="btn-group d-block" btnRadioGroup formControlName="PolicyPeriodCount">
          <button [btnRadio]="detail.Value" *ngFor="let detail of PolicyPeriodList" class="btn btn-outline-warning"
            tabindex="0">{{
            detail['Text'+lang.CURRENT]}}</button>
          <div class="invalid-feedback">
            {{ 'Message.STD00000' | translate }}
          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-sm-12 col-md-12">
          <label>{{ 'Label.LOTS03.Remark'| translate}}</label>
          <textarea formControlName="PolicyRemark" id="textarea-input" name="textarea-input" rows="4"
            class="form-control"></textarea>
        </div>
      </div>
    </form>
    <div class="form-row">
      <div class="form-group col-12 col-md-12 text-center">
        <button type="button" class="btn btn-primary" (click)="onSubmitContractPolicy()" [disabled]="saving">
          <i class="fas fa-save"></i> {{'Label.GLOBAL.Save'| translate}}
        </button>
        <button type="button" class="btn btn-primary" (click)="close()" [disabled]="saving">
          <i class="fas fa-times"></i> {{'Label.GLOBAL.Cancel'| translate}}
        </button>
      </div>
    </div>
  </modal-layout>
</ng-template>

<ng-template #removeContractProcess>
  <modal-layout (onClose)="closeRemoveContractProcess()" header="{{ 'ยืนยันการยกเลิกรายการรับชำระ' | translate }}">
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="col-10">
          <form [formGroup]="removeContractProcessForm" (ngSubmit)="onRemoveContractProcess()" novalidate>
            <div class="mb-3 text-secondary">{{ 'สาเหตุการยกเลิกรายการรับชำระ' | translate }}</div>
            <div class="form-group" [formGroup]="removeContractProcessForm">
              <textarea rows="3" class="form-control" formControlName="CancelRemark"></textarea>
            </div>
            <button type="submit" [disabled]="loadingContractProcess || removeContractProcessForm.invalid"
              class="btn btn-warning btn-block mb-3">
              <i class="fas fa-save" [hidden]="loadingContractProcess"></i>
              <i class="fas fa-cog fa-spin" [hidden]="!loadingContractProcess"></i>
              {{ 'ยืนยัน'| translate}}
            </button>
          </form>
        </div>
      </div>
    </div>
  </modal-layout>
</ng-template>

<ng-template #debtCollectionExpenses>
  <modal-layout (onClose)="closeDebtCollectionExpenses()" header="{{ 'บันทึกค่าใช้จ่ายติดตามหนี้' | translate }}">
    <div class="container-fluid">
      <div class="row justify-content-center">
        <div class="col-10">
          <form [formGroup]="debtCollectionExpensesForm" [class.validated]="submitted" [focusInvalid]="focusToggle"
            (ngSubmit)="onDebtCollectionExpensesProcess()">
            <div class="form-row">
              <div class="form-group col-sm-12 col-md-12">
                <label class="require">{{ 'วันที่ดำเนินการ'| translate}}</label>
                <input bsDatepicker class="form-control" type="text" formControlName="TrackingDate" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-sm-12 col-md-12">
                <label class="require" for="CategoryId">{{ 'ประเภทค่าใช้จ่าย'| translate
                  }}</label>
                <ng-select [items]="statusTracking" [bindLabel]="'Text'+lang.CURRENT" bindValue="Value"
                  formControlName="Status" placeholder="{{ 'Label.GLOBAL.PleaseSelect'| translate}}">
                </ng-select>
                <div class="invalid-feedback">
                  {{ 'Message.STD00000' | translate }}
                </div>
              </div>
            </div>
            <div class="form-row" *ngIf="this.debtCollectionExpensesForm.controls.Status.value == 'MF'">
              <div class="form-group col-sm-12 col-md-12">
                <label class="require">ค่าใช้จ่ายในการย้ายไฟแนนซ์</label>
                <ngx-numeric-textbox inputClass="form-control form-control" formControlName="MoveRefinanceAmount"
                  [decimals]="0">
                </ngx-numeric-textbox>
                <div class="invalid-feedback">
                  {{ 'Message.STD00000' | translate }}
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-sm-12 col-md-12">
                <label>หมายเหตุ</label>
                <textarea rows="3" class="form-control" formControlName="Remark"></textarea>
              </div>
            </div>
            <button type="submit" class="btn btn-warning btn-block mb-3">
              <i class="fas fa-save" [hidden]="loadingContractProcess"></i>
              <!-- <i class="fas fa-cog fa-spin" [hidden]="!loadingContractProcess"></i> -->
              {{ 'ยืนยัน'| translate}}
            </button>
          </form>
        </div>
      </div>
    </div>
  </modal-layout>
</ng-template>